<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
	
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Aplicacions ofimàtiques</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Aplicacions ofimàtiques">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Aplicacions ofimàtiques</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u5" class="parentnode"><p><a href="../../../WebContent/u5/resum.html">5. Bases de dades</a></p><ul class="expander"><li id="u5resum"><a href="../../../WebContent/u5/resum.html">Resum</a></li><li id="u5resultats"><a href="../../../WebContent/u5/resultats.html">Resultats d'aprenentatge i criteris d'avaluació</a></li><li id="u5referencies"><a href="../../../WebContent/u5/referencies.html">Referències</a></li><li id="u5a1" class="tocsection"><p id="u5a1continguts"><a href="../../../WebContent/u5/a1/continguts.html">Disseny i creació de bases de dades</a><span class="buttonexp"></span></p><ul><li id="u5a1activitats"><a href="../../../WebContent/u5/a1/activitats.html">Activitats</a></li><li id="u5a1exercicis"><a href="../../../WebContent/u5/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a2" class="tocsection"><p id="u5a2continguts"><a href="../../../WebContent/u5/a2/continguts.html">Taules</a><span class="buttonexp"></span></p><ul><li id="u5a2activitats"><a href="../../../WebContent/u5/a2/activitats.html">Activitats</a></li><li id="u5a2exercicis"><a href="../../../WebContent/u5/a2/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a3" class="tocsection"><p id="u5a3continguts"><a href="../../../WebContent/u5/a3/continguts.html">Consultes: definició i tipus</a><span class="buttonexp"></span></p><ul><li id="u5a3activitats"><a href="../../../WebContent/u5/a3/activitats.html">Activitats</a></li><li id="u5a3exercicis"><a href="../../../WebContent/u5/a3/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a4" class="tocsection"><p id="u5a4continguts"><a href="../../../WebContent/u5/a4/continguts.html">Formularis</a><span class="buttonexp"></span></p><ul><li id="u5a4activitats"><a href="../../../WebContent/u5/a4/activitats.html">Activitats</a></li><li id="u5a4exercicis"><a href="../../../WebContent/u5/a4/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a5" class="tocsection"><p id="u5a5continguts"><a href="../../../WebContent/u5/a5/continguts.html">Informes</a><span class="buttonexp"></span></p><ul><li id="u5a5activitats"><a href="../../../WebContent/u5/a5/activitats.html">Activitats</a></li><li id="u5a5exercicis"><a href="../../../WebContent/u5/a5/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a6" class="tocsection"><p id="u5a6continguts"><a href="../../../WebContent/u5/a6/continguts.html">Macros i altres eines</a><span class="buttonexp"></span></p><ul></ul></li></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../resum.html">Bases de dades</a></li><li><a href="continguts.html">Formularis</a></li><li>Activitats</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="activitats"> Activitats </a></h1>
    	
<h2><a id="creacio_d_un_formulari_amb_l_assistent" >Creació d&#039;un formulari amb l&#039;assistent</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a crear un formulari senzill de la taula <em>Clients</em>. 
</p>

<p>
Utilitzareu l’arxiu <em><div class="mediaf filezip"><div class="mediacontent"><a href="../media/base3.odb.zip">base3.odb</a><span> ( 46.7 KB )</span></div></div></em>.
</p>

<p>
Feu clic al botó <em>Formularis</em>, a la dreta de la finestra de base de dades. Un cop a la finestra de formularis, escolliu <em>Crea un formulari utilitzant l’auxiliar…</em> Seguiu les pantalles de l’assistent que se us obrirà per dissenyar un autoformulari de la taula <em>Clients</em>. Escolliu la disposició <em>Columnar - Etiquetes a l’esquerra</em> i la vista en <em>3D</em>. 
</p>

<p>
Si voleu canviar el color de fons del formulari o, fins i tot, substituir-lo per una imatge, feu clic amb el botó dret sobre qualsevol espai buit i seleccioneu  la comanda <em>Pàgina</em>. Seleccioneu la pestanya <em>Fons</em> i en la llista desplegable <em>Com a</em> trieu si voleu utilitzar un color o un gràfic de fons.
</p>

<p>
<form action=""><div class="solution ioccontent">
<p>
<div class="imgelem">
<img src="../media/sol_a2_1.png" alt="" /></div>

</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="creacio_d_un_formulari_en_vista_disseny" >Creació d&#039;un formulari en vista disseny</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a crear un formulari senzill de la taula <em>Categories</em>. 
</p>

<p>
Utilitzareu l’arxiu <div class="mediaf filezip"><div class="mediacontent"><a href="../media/base3.zip">base3.zip</a><span> ( 10.7 KB )</span></div></div>.
</p>

<p>
Si trieu l’opció <em>Crea un formulari en la vista disseny…</em> s’obrirà la finestra de disseny i el quadre d’eines en el qual hi ha els controls que es poden inserir en el formulari per tal que creeu manualment el formulari. Vegeu la figura <span class="figref"><a href="#form_disseny"><span>figura</span></a></span>
</p>
<div class="iocfigure"><a name="form_disseny"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Disseny formulari. Cos del formulari

</figcaption><img src="../media/form_disseny.png" alt="" /></figure>

</p>
</div>
<p>
Si els camps del control del formulari no apareixen, feu clic a <em>Veure/Barra d’eines/Camps de control del formulari</em> en el qual teniu els botons més utilitzats per al disseny d’un formulari:
</p>
<ul>
<li class="level1"><div class="li"> <em>Selecció</em>: activa/desactiva l’eina <em>Selecció</em> que permet seleccionar qualsevol dels camps que teniu inserits en el formulari.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>Mode disseny</em>: activa/desactiva el <em>Mode disseny</em> que permet activar el formulari per introduir-hi elements o bé desactivar-lo. En cas de desactivar-lo, no es podran inserir elements.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>Casella de selecció</em>: s’utilitza quan es vol desar un <em>Sí</em> o un <em>No</em>.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>Quadre de text</em>: insereix un quadre de text.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>Camp formatat</em>: permet inserir un camp formatat.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Botó: insereix un botó que executarà una acció determinada.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>Botó d’opció</em>: s’utilitza quan cal triar un valor entre un grup de valors.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>Quadre de llista</em>: mostra una llista de valors on es pot seleccionar el valor corresponent en cada cas.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>Quadre combinat</em>: mostra una llista desplegable on es pot seleccionar el valor corresponent en cada cas.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>Camp d’etiqueta</em>: insereix una etiqueta al formulari.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>Més camps de control</em>: permet veure més camps de control que poden ser útils en la creació del formulari.</div>
</li>
</ul>

<p>
<strong>Procediment</strong>
</p>

<p>
<strong>1.</strong> Obriu la base de dades.
</p>

<p>
<strong>2.</strong>  Seleccioneu <em>Objectes/Formulari</em> i escolliu la tasca <em>Crear formulari en vista disseny</em>.
</p>

<p>
<strong>3.</strong>  Deseu-lo amb el nom <em>FormCategories</em>.
</p>

<p>
<strong>4.</strong> En la vista disseny, cliqueu el botó <em>Camp d’etiqueta</em>, cliqueu el cos del formulari i dibuixeu un rectangle com podeu veure a la <span class="figref"><a href="#sol_a2-2"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="sol_a2-2"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Camp etiqueta

</figcaption><img src="../media/sol_a2_2.png" alt="" /></figure>

</p>
</div>
<p>
<strong>5.</strong> Establiu les propietats següents: 
</p>
<ul>
<li class="level1"><div class="li"> Tipus de lletra: Verdana, negreta, mida 18.</div>
</li>
<li class="level1"><div class="li"> Nom etiqueta: categories existents.</div>
</li>
</ul>

<p>
<strong>6.</strong> Introduiu un nou camp etiqueta anomenat <em>Categoria</em>, i al seu costat poseu-hi un camp de text, que permetrà veure els números de categories que anirà assignant el sistema. Si teniu algun problema a l’hora de situar el quadre de text en la posició que necessiteu, podeu ancorar el caràcter que apareix seleccionant en l’opció <em>Ancorar</em> del menú <em>Contextual</em>. Podeu veure el resultat a la <span class="figref"><a href="#sol_a2_3"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="sol_a2_3"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Camp etiqueta

</figcaption><img src="../media/sol_a2_3.png" alt="" /></figure>

</p>
</div>
<p>
<strong>7.</strong> Establiu les propietats següents: 
</p>
<ul>
<li class="level1"><div class="li"> Tipus de lletra: Verdana, negreta, mida 14, cursiva.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Nom etiqueta: categoria.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Vores: gris al 80%.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Per assignar el color de fons desitjat al formulari, feu clic sobre el botó dret en un lloc lliure del formulari i indiquem l’opció <em>Pàgina</em>. A continuació, aneu a la pestanya <em>Fons</em> i trieu el color verd pastel.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Origen de dades del formulari: taula <em>Categories</em>.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Origen de dades del camp de text: <em>IdCategoria</em>.</div>
</li>
</ul>
<div class="iocimportant"><div class="ioccontent">
<p>
Per establir l’origen de dades recordeu seleccionar la pestanya <em>Dades</em> del menú contextual <em> Propietats</em>.
</p>
</div></div>
<p>
<strong>8.</strong> Executeu el formulari i com a resultat obtindreu la <span class="figref"><a href="#sol_a2_4"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="sol_a2_4"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

 Solució formulari

</figcaption><img src="../media/sol_a2_4.png" alt="" /></figure>

</p>
</div>
</div>

<h2><a id="creacio_d_un_formulari_amb_subformulari" >Creació d&#039;un formulari amb subformulari</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a crear un formulari que relacioni les comandes rebudes amb el contingut de cada comanda.
</p>

<p>
Utilitzareu l’arxiu <div class="mediaf filezip"><div class="mediacontent"><a href="../media/base3.zip">base3.zip</a><span> ( 10.7 KB )</span></div></div> i realitzareu un formulari amb subformulari que relacioni les comandes amb els detalls de comandes i al qual anomenareu <em>Formdetallcomanda</em>.
</p>

<p>
<strong>Procediment</strong>
</p>
<ul>
<li class="level1"><div class="li"> Obriu l’assistent.</div>
</li>
<li class="level1"><div class="li"> Seleccioneu la taula <em>Comandes</em>.</div>
</li>
<li class="level1"><div class="li"> Seleccioneu els camps <em>IdComanda</em>, <em>Data</em>, <em>IdClient</em>.</div>
</li>
<li class="level1"><div class="li"> Al pas següent, activeu la casella <em>Afegir un subformulari</em>.</div>
</li>
<li class="level1"><div class="li"> Al tercer pas escollireu la taula <em>Detall_comanda</em> i escollireu els camps <em>Quantitat</em>, <em>Preu</em> i <em>Referència</em>. El camp <em>IdComanda</em> no cal ja que formarà part del formulari principal.</div>
</li>
<li class="level1"><div class="li"> Establiu la distribució dels camps i escolliu un color de fons.</div>
</li>
<li class="level1"><div class="li"> Modifiqueu l’ordre de les columnes del subformulari tal com mostra la figura  <span class="figref"><a href="#sol_a3_1"><span>figura</span></a></span>.</div>
</li>
</ul>
<div class="iocfigure"><a name="sol_a3_1"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Formulari amb subformulari

</figcaption><img src="../media/sol_a3_1.png" alt="" /></figure>

</p>
</div>
<p>
Utilitzeu els botons de la <em>Barra de navegació</em> del formulari per visualitzar el resultat vinculat entre cada comanda i els productes que la formen.
</p>

<p>
<form action=""><div class="solution ioccontent">
<p>
<div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a3_1.zip">sol_a3_1.zip</a><span> ( 17 KB )</span></div></div>
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="creacio_de_quadres_de_llista_en_un_formulari" >Creació de quadres de llista en un formulari</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és modificar el disseny dels formularis realitzats de forma automàtica per tal de facilitar la introducció de dades.
</p>

<p>
Recupereu el fitxer <div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a3_1.zip">sol_a3_1.zip</a><span> ( 17 KB )</span></div></div> que, com veureu, conté el formulari <em>Formdetallcomanda</em>.
Com podeu comprovar, tot i que permet inserir dades tant al formulari com al subformulari, és poc intuïtiu. L’usuari ha de conèixer el codi del client i del producte. Ho resoldrem creant dos quadres de llista.
</p>

<p>
<strong>Procediment:</strong>
</p>

<p>
<strong>1.</strong> Obriu el formulari <em>Form_detall_comanda</em> en la vista disseny.
</p>

<p>
<strong>2.</strong> Escolliu el botó de control <em>Quadre de llista</em> <div class="iocfigurec">
<ul>
<li>
<img src="../media/quadre_llista.png" class="imgB" alt="" /></li></ul></div>
, que permet mostrar la llista de clients amb un quadre desplegable, i feu un rectangle al costat del codi del client al formulari.
</p>

<p>
<strong>3.</strong> S’obrirà l’assistent del control quadre de llista. Escolliu la taula <em>Clients</em> i premeu <em>Següent</em>, d’acord amb la imatge <span class="figref"><a href="#assistent_quadre_llista_1"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="assistent_quadre_llista_1"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Assistent quadre llista 1

</figcaption><img src="../media/assistent_quadre_llista_1.png" alt="" /></figure>

</p>
</div>
<p>
<strong>4.</strong> Seleccioneu el camp que voleu visualitzar a la pantalla que mostra la imatge <span class="figref"><a href="#assisten_quadre_llista_2"><span>figura</span></a></span>, en aquest cas <em>Cognoms</em>.
</p>
<div class="iocfigure"><a name="assisten_quadre_llista_2"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Assistent quadre llista 2

</figcaption><img src="../media/assisten_quadre_llista_2.png" alt="" /></figure>

</p>
</div>
<p>
<strong>5.</strong> Configureu el vincle existent entre la taula <em>Comandes</em> i la taula <em>Clients</em>. Configureu la relació existent entre el que es vol mostrar al quadre de llista i el formulari. En el nostre cas <em>IdClient</em>, tal com es mostra a la imatge <span class="figref"><a href="#assitent_quadre_llista_vincular_camp"><span>figura</span></a></span>. 
</p>
<div class="iocfigure"><a name="assistent_quadre_llista_vincular_camp"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Vincular camp

</figcaption><img src="../media/assistent_quadre_llista_vincular_camp.png" alt="" /></figure>

</p>
</div>
<p>
<strong>6.</strong> Finalitzeu i tanqueu el formulari. Si deseu els canvis i obriu el formulari podreu comprovar que el vostre quadre funciona perfectament. Quan poseu el codi d’un client us mostra el seu cognom al quadre que acabeu de crear. 
</p>

<p>
<strong>7.</strong> Esborreu el quadre de text del camp <em>IdClient</em>, seleccionant-lo prèviament amb la tecla <em>Ctrl</em>, i substituïu-lo per un nou quadre de llista que mostri el nom del client, seguint el mateix procediment que heu utilitzat per al camp <em>Cognoms</em>.
</p>

<p>
<strong>8.</strong> Canvieu el títol de l’etiqueta <em>IdClient</em> per <em>Client</em> i modifiqueu el color i vores dels quadres de llista per tal que quedin tots iguals. El resultat ha de ser semblant a la figura <span class="figref"><a href="#quadre_llista_final"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="quadre_llista_final"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Formulari final

</figcaption><img src="../media/quadre_llista_final.png" alt="" /></figure>

</p>
</div>
<p>
Podeu veure les diferents propietats dels botons a la figura <span class="figref"><a href="#finestra_propietats"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="finestra_propietats"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Diferents propietats i controls

</figcaption><img src="../media/finestra_propietats.png" alt="" /></figure>

</p>
</div>
<p>
<form action=""><div class="solution ioccontent">
<p>
<div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a4_1.zip">sol_a4_1.zip</a><span> ( 17.9 KB )</span></div></div>
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="creacio_d_un_quadre_llista_en_un_subformulari" >Creació d&#039;un quadre llista en un subformulari</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és modificar el disseny d’un subformulari realitzat de forma automàtica per tal de facilitar la introducció de dades.
</p>

<p>
<strong>Procediment</strong>
</p>

<p>
<strong>1.</strong> Recupereu el fitxer <div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a4_1.zip">sol_a4_1.zip</a><span> ( 17.9 KB )</span></div></div> i obriu el formulari <em>Form_detall_comanda</em>en vista disseny.
</p>

<p>
<strong>2.</strong> A la graella del subformulari hi ha 3 columnes: <em>Referència</em>, <em>Quantitat</em>, i <em>Preu</em>, i voleu que en lloc de la referència es mostri el nom del producte i es pugui escollir d’una llista.
</p>

<p>
<strong>3.</strong> Seleccioneu la columna <em>Referència</em> i amb el botó dret del ratolí, escolliu <em>Suprimeix la columna</em> al menú contextual.
</p>

<p>
<strong>4.</strong> Creareu una columna nova que serà el quadre llista per mostrar els productes. Cliqueu sobre la columna <em>Quantitat</em> i al botó dret del ratolí, escolliu <em>Insereix una columna</em> i a continuació <em>Quadre de llista</em> com mostra la imatge <span class="figref"><a href="#Figura 2.1.20"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="Figura 2.1.20"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Columna de quadre de llista

</figcaption><img src="../media/2.1.20.png" alt="" /></figure>

</p>
</div>
<p>
<strong>5.</strong> Apareix una columna nova amb el nom <em>Quadre llista 1</em> que cal configurar.
</p>

<p>
<strong>6.</strong> Seleccioneu la columna <em>Quadre llista 1</em> i amb el botó dret del ratolí, escolliu <em>Columna</em> i en obrir les <em>Propietats: Quadre de llista</em>, modificareu els següents paràmetres:
</p>
<ul>
<li class="level1"><div class="li"> <em>Dades / Camp de dades</em>: cal indicar la dada que voleu mostrar al subformulari, en el cas que ens ocupa, la dada que heu d’escollir és <em>Referència</em>.</div>
</li>
<li class="level1"><div class="li"> <em>Tipus de contingut de la llista</em>: pot venir de diverses fonts; llista de valors, taula, consulta, <acronym title="Structured Query Language">SQL</acronym> o camp de taula. Escolliu <acronym title="Structured Query Language">SQL</acronym> ja que voleu obtenir el nom del producte de la taula <em>Productes</em> i que el seu codi estigui enllaçat amb la taula <em>Detall comandes</em>. </div>
</li>
<li class="level1"><div class="li"> <em>Contingut de la llista</em>: com que heu definit l’origen <acronym title="Structured Query Language">SQL</acronym>, premeu el botó <div class="iocfigurec">
<ul>
<li>
<img src="../media/contingul_llista.png" class="imgB" alt="" /></li></ul></div>
 que figura a l’opció <em>Contingut de la llista</em> per realitzar una consulta. Escolliu la taula <em>Productes</em> i seleccioneu els camps <em>Nom</em> i <em>Referència</em> com mostra la imatge <span class="figref"><a href="#Figura2.1.21"><span>figura</span></a></span>. Un cop finalitzada la consulta la deseu i tanqueu la pantalla.</div>
</li>
</ul>
<div class="iocfigure"><a name="Figura 2.1.21"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Consulta

</figcaption><img src="../media/2.1.21.png" alt="" /></figure>

</p>
</div><ul>
<li class="level1"><div class="li"> <em>Camp lligat</em>: és el camp que ha de mostrar la llista. Indiqueu el valor <em>1</em>. Aquesta acció permet vincular la <em>Referencia</em> de la taula <em>Productes</em> amb <em>Referencia</em> de la taula <em>Detall comanda</em>. Podeu veure el resultat a la <span class="figref"><a href="#Figura 2.1.22"><span>figura</span></a></span>.</div>
</li>
</ul>
<div class="iocfigure"><a name="Figura 2.1.22"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Vinculació Productes-Detall comanda

</figcaption><img src="../media/2.1.22.png" alt="" /></figure>

</p>
</div><ul>
<li class="level1"><div class="li"> Sense tancar la fitxa de propietats, premeu la pestanya <em>General</em> i modifiqueu-ne els paràmetres especificats. <em>Etiqueta</em>: Nom del producte, <em>Amplada</em>: 7,00cm.</div>
</li>
<li class="level1"><div class="li"> Un cop realitzades les modificacions, tanqueu la pantalla i deseu els canvis. En tancar el formulari i tornar-lo a obrir observareu que es poden seleccionar els productes dins de la graella de dades (subformulari). Podeu veure el resultat a la <span class="figref"><a href="#Figura 2.1.23"><span>figura</span></a></span></div>
</li>
</ul>
<div class="iocfigure"><a name="Figura 2.1.23"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Selecció de productes

</figcaption><img src="../media/2.1.23.png" alt="" /></figure>

</p>
</div>
<p>
<form action=""><div class="solution ioccontent">
<p>
<div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a5_1.zip">sol_a5_1.zip</a><span> ( 18 KB )</span></div></div>
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="creacio_d_un_camp_calculat" >Creació d&#039;un camp calculat</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és crear un camp calculat en un subformulari.
</p>

<p>
Afegireu un nou camp al subformulari que calculi de forma automàtica el cost (quantitat × preu) de cada article que s’afegeixi al subformulari.
</p>

<p>
<strong>Procediment</strong>
</p>

<p>
<strong>1.</strong> Recupereu el fitxer <div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a5_1.zip">sol_a5_1.zip</a><span> ( 18 KB )</span></div></div> i obriu el formulari <em>Form_detall_comanda</em> en vista disseny. Seleccioneu el subformulari, tal com s’indica a la imatge <span class="figref"><a href="#sol2.1.1"><span>figura</span></a></span>, i amb el botó dret del ratolí seleccioneu <em>Formulari</em> del menú contextual. 
</p>
<div class="iocfigure"><a name="sol2.1.1"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

selecció subformulari

</figcaption><img src="../media/sol2.1.1.png" alt="" /></figure>

</p>
</div>
<p>
<strong>2.</strong> Observeu que a la pestanya <em>Dades</em> l’origen és la taula <em>Detall_Comanda</em> que inclou els camps: <em>IdComanda, Referència, Quantitat i Preu</em>. No podeu afegir-hi un camp calculat perquè aquesta acció suposaria modificar la taula. La solució consisteix a canviar l’origen de dades per una consulta <acronym title="Structured Query Language">SQL</acronym>, que us permetrà realitzar les mateixes operacions que en una taula i, a més, hi podreu incloure un camp calculat. L’opció <em>Tipus de contingut</em> de la fitxa de <em>Propietats del formulari</em>, pestanya <em>Dades</em> ofereix tres posssibilitats:
</p>
<ul>
<li class="level1"><div class="li"> <em>Taula</em>: per seleccionar una taula</div>
</li>
<li class="level1"><div class="li"> <em>Consulta</em>: per seleccionar una consulta ja creada</div>
</li>
<li class="level1"><div class="li"> <em>Ordre <acronym title="Structured Query Language">SQL</acronym></em>: per crear una nova consulta</div>
</li>
</ul>

<p>
Modifiqueu l’opció <em>Tipus de contingut</em>, de la fitxa de propietats del subformulari, canvieu-la per <em>Ordre <acronym title="Structured Query Language">SQL</acronym></em> i premeu el botó<div class="iocfigurec">
<ul>
<li>
<img src="../media/contingul_llista.png" class="imgB" alt="" /></li></ul></div>
 a la dreta de l’opció <em>Contingut</em>. Us apareixerà la pantalla de disseny de consultes i podreu crear una nova ordre <acronym title="Structured Query Language">SQL</acronym>, tal com es mostra a la imatge <span class="figref"><a href="#sol2.1.3"><span>figura</span></a></span>
</p>
<div class="iocfigure"><a name="sol2.1.3"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Ordre <acronym title="Structured Query Language">SQL</acronym>

</figcaption><img src="../media/sol2.1.3.png" alt="" /></figure>

</p>
</div>
<p>
<strong>3.</strong>
 A la pantalla de disseny de la consulta escolliu la taula <em>Detall_Comanda</em> i seleccioneu els camps <em>IdComanda</em>, <em>Referència</em>, <em>Quantitat</em>, i <em>Preu</em>. Al final de la graella de la consulta definiu un camp calculat a partir de l’operació quantitat*preu.
</p>
<ul>
<li class="level1"><div class="li"> Camp: Quantitat*Preu</div>
</li>
<li class="level1"><div class="li"> Àlies: Subtotal</div>
</li>
<li class="level1"><div class="li"> Taula: Detall de comanda</div>
</li>
<li class="level1"><div class="li"> Visible: Activat.</div>
</li>
</ul>

<p>
La pantalla de disseny ha de quedar configurada tal com mostra la imatge <span class="figref"><a href="#sol2.2.2"><span>figura</span></a></span>
</p>
<div class="iocfigure"><a name="sol2.2.2"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Disseny consulta

</figcaption><img src="../media/sol2.2.2.png" alt="" /></figure>

</p>
</div>
<p>
<strong>4.</strong> Un cop definit el camp calculat deseu les dades i tanqueu la pantalla de creació de consultes. Tornareu a la finestra <em>Propietats del formulari</em>, i veureu que l’origen de les dades ja ha canviat. La finestra s’ha transformat d’acord amb la imatge <span class="figref"><a href="#sol2.1.4"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="sol2.1.4"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Propietats del camp calculat

</figcaption><img src="../media/sol2.1.4.png" alt="" /></figure>

</p>
</div>
<p>
<strong>5.</strong> Tanqueu la finestra de <em>Propietats del formulari</em> i afegiu una nova columna a la graella de dades. Feu clic amb el botó dret als costat del camp <em>Preu</em>, escolliu <em>Insereix una columna</em> i, a continuació, <em>Camp formatat</em>. Heu d’escollir aquesta última opció en lloc de <em>Quadre de text</em> per així poder definir com voleu visualitzar el nou camp.
</p>

<p>
<strong>6.</strong> Apareixerà una nova columna amb el nom <em>Quadre de text 1</em> i caldrà configurar-la per tal que mostri el nou camp calculat. Situeu-vos sobre la nova columna, premeu el botó dret del ratolí i seleccioneu l’opció <em>Columna</em> del menú contextual. Us apareixerà la finestra <em>Propietats: Camp formatat</em>. Situeu-vos a la pestanya <em>Dades</em>, obriu el desplegable de l’opció <em>Camp de dades</em> i seleccioneu el camp calculat que acabeu de crear. La finestra de propietats ha de quedar configurada tal com mostra la imatge <span class="figref"><a href="#sol2.1.5"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="sol2.1.5"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Propietats del camp formatat

</figcaption><img src="../media/sol2.1.5.png" alt="" /></figure>

</p>
</div>
<p>
<strong>7.</strong> Accediu a la pestanya <em>General</em> i feu que el títol de la columna sigui <em>Subtotal del producte</em>. A l’opció <em>Només lectura</em> poseu-hi <em>Sí</em>, per tal que no s’hi pugui escriure. A continuació definiu el format de les dades. Aneu a l’opció <em>Formatació</em> i premeu el botó <div class="iocfigurec">
<ul>
<li>
<img src="../media/contingul_llista.png" class="imgB" alt="" /></li></ul></div>
 per seleccionar un dels possibles formats. Seleccioneu la categoria <em>Moneda</em> i el format <em>-1.234,00 €</em>, d’acord amb la imatge <span class="figref"><a href="#sol2.1.6"><span>figura</span></a></span> i accepteu.
</p>
<div class="iocfigure"><a name="sol2.1.6"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Format moneda 

</figcaption><img src="../media/sol2.1.6.png" alt="" /></figure>

</p>
</div>
<p>
La finestra <em>Propietats: camp formatat</em> ha de quedar tal com mostren les imatges <span class="figref"><a href="#sol2.1.7"><span>figura</span></a></span> i <span class="figref"><a href="#sol2.1.8"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="sol2.1.7"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Propietats del camp formatat

</figcaption><img src="../media/sol2.1.7.png" alt="" /></figure>

</p>
</div><div class="iocfigure"><a name="sol2.1.8"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Propietats del camp formatat definitiu

</figcaption><img src="../media/sol2.1.8.png" alt="" /></figure>

</p>
</div>
<p>
<strong>8.</strong> Tanqueu la finestra <em>Propietats: Camp formatat</em> i, abans de tancar el formulari, modifiqueu la mida de la graella i de la finestra principal per adaptar-les a la mida adequada. A continuació deseu els canvis. Si obriu de nou el formulari per treballar-hi veureu que la columna <em>Calcula les dades automàticament</em> mostra les dades amb el format que heu definit, tal com mostra la imatge <span class="figref"><a href="#sol2.1.9"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="sol2.1.9"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Resultat del camp formatat

</figcaption><img src="../media/sol2.1.9.png" alt="" /></figure>

</p>
</div>
<p>
<form action=""><div class="solution ioccontent">
<p>
<div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a6_1.zip">sol_a6_1.zip</a><span> ( 18.2 KB )</span></div></div>
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="creacio_d_un_camp_calculat_total" >Creació d&#039;un camp calculat total</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és crear un camp calculat en un formulari.
</p>

<p>
Afegireu un nou camp a un formulari que sumarà els imports que figuren als diferents registres del subformulari que conté per calcular l’import d’una comanda.
</p>

<p>
<strong>Procediment</strong>
</p>

<p>
<strong>1.</strong> Recupereu el fitxer <div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a6_1.zip">sol_a6_1.zip</a><span> ( 18.2 KB )</span></div></div> i obriu el formulari <em>Form_detall_comanda</em> en vista disseny. 
</p>

<p>
<strong>2.</strong> Abans d’incorporar el nou camp calculat, caldrà que afegiu un nou subformulari al formulari principal. Cal aquest pas previ perquè com que el formulari principal depèn de la taula <em>Comandes</em> no hi podeu associar el nou camp calculat. I tampoc el podeu associar al subformulari perquè depèn de la taula <em>Detall_comanda</em> per mostrar tots els registres de la taula associats a la de <em>Comandes</em>, però no permet calcular el total de cada comanda. Així doncs, en primer lloc, haureu d’obrir el navegador del formulari prement el botó <div class="iocfigurec">
<ul>
<li>
<img src="../media/navegador_form.png" class="imgB" alt="" /></li></ul></div>
 i apareixerà el desplegable del navegador com es mostra a la imatge <span class="figref"><a href="#sol2.1.10"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="sol2.1.10"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Navegador del formulari

</figcaption><img src="../media/sol2.1.10.png" alt="" /></figure>

</p>
</div>
<p>
<strong>3.</strong> Al navegador del formulari hi apareix el formulari principal (amb el nom <em>MainForm</em>) i el subformulari (amb el nom <em>SubForm</em>). La resta són els diversos objectes que conté el formulari. Haureu d’afegir un nou subformulari al formulari principal, atès que el formulari serà el lloc on es mostrarà el càlcul del total de la comanda. Premeu el botó dret del ratolí sobre el formulari principal i al menú contextual que apareix seleccioneu <em>Nou</em> seguit de <em>Formulari</em>, per tal d’inserir un nou subformulari que dependrà del formulari principal.
</p>

<p>
<strong>4.</strong> En inserir el nou subformulari, a la finestra del <em>Navegador de formulari</em> hi apareixerà un nou formulari amb el nom de <em>Formulari</em>. Canvieu-li el nom per <em>CalculTotal</em> utilitzant l’opció corresponent del menú contextual que us apareixerà clicant el botó dret del ratolí. La finestra del <em>Navegador de formularis</em> us quedarà tal com mostra la imatge <span class="figref"><a href="#sol2.1.11"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="sol2.1.11"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Navegador amb un nou formulari

</figcaption><img src="../media/sol2.1.11.png" alt="" /></figure>

</p>
</div>
<p>
<strong>5.</strong> A continuació definireu les dades que ha de mostrar el nou subformulari. Seleccioneu-lo a la finestra del <em>Navegador de formulari</em>, premeu el botó dret del ratolí per obrir el menú contextual i seleccioneu l’opció <em>Propietats</em>. Us apareix la pantalla de <em>Propietats del formulari</em> d’acord amb la imatge <span class="figref"><a href="#sol2.1.12"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="sol2.1.12"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Propietats del nou formulari

</figcaption><img src="../media/sol2.1.12.png" alt="" /></figure>

</p>
</div>
<p>
<strong>6.</strong> Seleccioneu la pestanya <em>Dades</em> per indicar quin serà l’origen de les dades del formulari. Com que heu de crear un camp calculat a l’apartat <em>Tipus de contingut</em> seleccionareu l’opció <em>Ordre <acronym title="Structured Query Language">SQL</acronym></em>, i així podreu definir la consulta que necessiteu. Premeu el botó <div class="iocfigurec">
<ul>
<li>
<img src="../media/contingul_llista.png" class="imgB" alt="" /></li></ul></div>
 per definir la consulta que ha de tenir el següent disseny:
</p>
<div class="iocfigure"><a name="sol2.1.13"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Disseny consulta total

</figcaption><img src="../media/sol2.1.13.png" alt="" /></figure>

</p>
</div>
<p>
Com que voleu calcular el total de cada comanda, seleccionareu la taula de <em>Detalls_Comanda</em>. A continuació incorporareu el camp <em>IdComanda</em> i el camp calculat <em>Quantitat*Preu</em> i per últim afegireu la funció <em>Grup</em> al camp <em>IdComanda</em> i la funció <em>Suma</em> al camp calculat per tal que sumi, per cada comanda, la quantitat pel preu de cada producte. Com que cada comanda inclou diversos registres de la taula <em>Detalls_Comanda</em>  cal <strong>agrupar</strong> per <em>IdComanda</em> i sumar tots els càlculs de <em>Quantitat*Preu</em>. Poseu l’àlies <em>Total</em> a la suma d’aquest últim camp.
</p>

<p>
<strong>7.</strong> En acabar, deseu la consulta i tanqueu la finestra de disseny. Tornareu a la finestra <em>Propietats del formulari</em> i haureu de canviar la funció <em>Suma</em> de l’ordre <acronym title="Structured Query Language">SQL</acronym> de l’opció <em>Contingut</em> per la funció <em>Sum</em>. Aquest és el nom de la funció en <acronym title="Structured Query Language">SQL</acronym> i cal canviar-lo perquè la traducció que ha fet LibreOffice Base a partir de la pantalla de disseny no és del tot correcta. La finestra <em>Propietats del formulari</em> ha de quedar de la següent manera:
</p>
<div class="iocfigure"><a name="sol2.1.14"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Modificació sentència <acronym title="Structured Query Language">SQL</acronym>

</figcaption><img src="../media/sol2.1.14.png" alt="" /></figure>

</p>
</div>
<p>
<strong>8.</strong> També des de la finestra <em>Propietats del formulari</em>, pestanya <em>Dades</em>, opció <em>Enllaç als camps mestres</em>, haureu de configurar el vincle existent entre el nou subformulari i la taula <em>Comandes</em>. La relació es farà a partir del camp comú <em>IdComanda</em>.
</p>

<p>
<strong>9.</strong> Un cop definit l’origen de les dades i configurada la relació, tanqueu la pantalla. Assegureu-vos que al <em>Navegador de formularis</em> esteu situats damunt del subformulari i afegiu un control <em>Camp formatat</em> al formulari principal. Es veurà en el formulari principal però estarà enganxat al nou subformulari. Afegiu també un control tipus <em>Camp d’etiqueta</em> amb el nom <em>Total</em> i situeu-lo davant del control de <em>Camp formatat</em>. Modifiqueu les propietats dels controls , com ara color o mida, per tal que el format sigui similar al de la resta del mateix tipus. Com podeu veure a la imatge <span class="figref"><a href="#sol2.1.15"><span>figura</span></a></span> el camp formatat i l’etiqueta han de quedar dins del nou subformulari.
</p>
<div class="iocfigure"><a name="sol2.1.15"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Navegador formulari

</figcaption><img src="../media/sol2.1.15.png" alt="" /></figure>

</p>
</div>
<p>
<strong>10</strong> Assigneu l’origen de dades al nou camp formatat perquè mostri el camp calculat que heu creat. Premeu el botó dret sobre el camp formatat, accediu a la fitxa de propietats del control des de l’opció <em>Control…</em> i des de la pestanya <em>Dades</em> assigneu el camp <em>Total</em> a l’opció <em>Camp de dades</em>.
</p>

<p>
A la pestanya de <em>General</em>, a l’opció <em>Només lectura</em> poseu-hi <em>Sí</em>, per tal que no s’hi pugui escriure. A continuació definiu el format de les dades. Aneu a l’opció <em>Formatació</em> i premeu el botó <div class="iocfigurec">
<ul>
<li>
<img src="../media/contingul_llista.png" class="imgB" alt="" /></li></ul></div>
 per seleccionar un dels possibles formats. Seleccioneu la categoria <em>Moneda</em> i el format <em>-1.234,00 €</em>.
</p>
<div class="iocfigure"><a name="sol2.1.16"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Propietats del camp formatat

</figcaption><img src="../media/sol2.1.16.png" alt="" /></figure>

</p>
</div>
<p>
<strong>11.</strong> Tanqueu la finestra de propietats i modifiqueu el format dels controls per tal que el seu aspecte sigui similar al de la imatge <span class="figref"><a href="#sol2.1.17"><span>figura</span></a></span>. Per acabar, deseu els canvis i obriu el formulari. Comprovareu que s’estan calculant els totals de cada comanda.
</p>
<div class="iocfigure"><a name="sol2.1.17"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

 Resultat final

</figcaption><img src="../media/sol2.1.17.png" alt="" /></figure>

</p>
</div>
<p>
<form action=""><div class="solution ioccontent">
<p>
<div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a7_1.zip">sol_a7_1.zip</a><span> ( 18.4 KB )</span></div></div>
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="introduccio_de_nous_controls_en_un_formulari" >Introducció de nous controls en un formulari</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és afegir controls en un formulari.
</p>

<p>
Afegireu el camp <em>Lliurat</em> de la taula <em>Comandes</em> al formulari per indicar si el lliurament s’ha fet o no.
</p>

<p>
<strong>Procediment</strong>
</p>

<p>
<strong>1.</strong> Recupereu el fitxer <div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a7_1.zip">sol_a7_1.zip</a><span> ( 18.4 KB )</span></div></div> i obriu el formulari <em>Form_detall_comanda</em> en vista disseny. 
</p>

<p>
<strong>2.</strong> Seleccioneu el control <em>Casella de selecció</em> de la barra de controls de formulari i dibuixeu la casella al formulari, a la posició que mostra la imatge <span class="figref"><a href="#formcasellaverificacio"><span>figura</span></a></span>.
</p>

<p>
<strong>3.</strong> Premeu el botó dret del ratolí sobre la casella de selecció que acabeu d’inserir i, en el menú contextual que apareix, seleccioneu l’opció <em>Control</em>, per tal d’accedir a la pantalla de propietats del control. A la pestanya <em>General</em> realitzeu-hi els següents canvis: 
</p>
<ul>
<li class="level1"><div class="li"> <em>Etiqueta</em>: no poseu cap etiqueta.</div>
</li>
<li class="level1"><div class="li"> <em>Estil</em>: seleccioneu l’estil 3D.</div>
</li>
<li class="level1"><div class="li"> <em>Color de fons</em>: gris al 10%.</div>
</li>
</ul>

<p>
A la pestanya <em>Dades</em>, a l’opció <em>Camp de dades</em>, escolliu <em>Lliurat</em>, que serà el camp origen de dades del control. 
</p>

<p>
Un cop realitzats aquests canvis tanqueu la fitxa de propietats del control.
</p>
<div class="iocfigure"><a name="formcasellaverificacio"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

 Formulari amb casella de verificació

</figcaption><img src="../media/formcasellaverificacio.png" alt="" /></figure>

</p>
</div>
<p>
<strong>4.</strong> Seleccioneu el control <em>Camp d’etiqueta</em> de la barra de controls de formulari i dibuixeu-lo al formulari, a la posició que mostra la imatge <span class="figref"><a href="#sol2.1.18"><span>figura</span></a></span>. Premeu el botó dret del ratolí sobre l’etiqueta que acabeu d’inserir i, en el menú contextual que apareix, seleccioneu l’opció <em>Control</em>, per tal d’accedir a la pantalla de propietats del control. A la pestanya <em>General</em> realitzeu-hi els següents canvis: 
</p>
<ul>
<li class="level1"><div class="li"> <em>Etiqueta</em>: Comanda lliurada?</div>
</li>
<li class="level1"><div class="li"> <em>Font</em>: seleccioneu que el color de la font sigui igual que la resta d’etiquetes del formulari.</div>
</li>
</ul>

<p>
<strong>5.</strong> Tanqueu la fitxa de propietats. El resultat ha de ser semblant al que mostra la imatge <span class="figref"><a href="#sol2.1.18"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="sol2.1.18"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Resultat final del formulari

</figcaption><img src="../media/sol2.1.18.png" alt="" /></figure>

</p>
</div>
<p>
<form action=""><div class="solution ioccontent">
<p>
<div class="mediaf filezip"><div class="mediacontent"><a href="../media/sol_a8_1.zip">sol_a8_1.zip</a><span> ( 18.5 KB )</span></div></div>
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u5/a4/continguts.html">Formularis</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u5/a4/exercicis.html">Exercicis d'autoavaluació</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
