<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
	
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Aplicacions ofimàtiques</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Aplicacions ofimàtiques">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Aplicacions ofimàtiques</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u5" class="parentnode"><p><a href="../../../WebContent/u5/resum.html">5. Bases de dades</a></p><ul class="expander"><li id="u5resum"><a href="../../../WebContent/u5/resum.html">Resum</a></li><li id="u5resultats"><a href="../../../WebContent/u5/resultats.html">Resultats d'aprenentatge i criteris d'avaluació</a></li><li id="u5referencies"><a href="../../../WebContent/u5/referencies.html">Referències</a></li><li id="u5a1" class="tocsection"><p id="u5a1continguts"><a href="../../../WebContent/u5/a1/continguts.html">Disseny i creació de bases de dades</a><span class="buttonexp"></span></p><ul><li id="u5a1activitats"><a href="../../../WebContent/u5/a1/activitats.html">Activitats</a></li><li id="u5a1exercicis"><a href="../../../WebContent/u5/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a2" class="tocsection"><p id="u5a2continguts"><a href="../../../WebContent/u5/a2/continguts.html">Taules</a><span class="buttonexp"></span></p><ul><li id="u5a2activitats"><a href="../../../WebContent/u5/a2/activitats.html">Activitats</a></li><li id="u5a2exercicis"><a href="../../../WebContent/u5/a2/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a3" class="tocsection"><p id="u5a3continguts"><a href="../../../WebContent/u5/a3/continguts.html">Consultes: definició i tipus</a><span class="buttonexp"></span></p><ul><li id="u5a3activitats"><a href="../../../WebContent/u5/a3/activitats.html">Activitats</a></li><li id="u5a3exercicis"><a href="../../../WebContent/u5/a3/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a4" class="tocsection"><p id="u5a4continguts"><a href="../../../WebContent/u5/a4/continguts.html">Formularis</a><span class="buttonexp"></span></p><ul><li id="u5a4activitats"><a href="../../../WebContent/u5/a4/activitats.html">Activitats</a></li><li id="u5a4exercicis"><a href="../../../WebContent/u5/a4/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a5" class="tocsection"><p id="u5a5continguts"><a href="../../../WebContent/u5/a5/continguts.html">Informes</a><span class="buttonexp"></span></p><ul><li id="u5a5activitats"><a href="../../../WebContent/u5/a5/activitats.html">Activitats</a></li><li id="u5a5exercicis"><a href="../../../WebContent/u5/a5/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><li id="u5a6" class="tocsection"><p id="u5a6continguts"><a href="../../../WebContent/u5/a6/continguts.html">Macros i altres eines</a><span class="buttonexp"></span></p><ul></ul></li></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../resum.html">Bases de dades</a></li><li>Taules</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="taules"> Taules </a></h1>
    	
<p>
Les taules d’una base de dades en conformen l’estructura principal, podríem dir que es tracta dels fonaments bàsics de l’estructura. Cada taula conté la informació que utilitzaran la resta d’objectes de la base de dades: consultes, formularis, informes…
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El disseny de les taules ha de ser un procés meditat en el qual heu de tenir en compte les necessitats i la finalitat a les quals estarà destinada la vostra base de dades.
</p>
</div></div>
<h2><a id="creacio_de_taules" >Creació de taules</a></h2>
<div class="level2">

<p>
Hi ha dues formes de crear taules en base, utilitzant l’<em>Auxiliar</em> o bé emprant l’eina de <em>Disseny de taula</em>. L’assistent ofereix algunes facilitats però també certes limitacions. És per això que en primer lloc ens decantarem per l’opció de disseny de taules.
</p>

<p>
A la finestra <em>Disseny de taula</em> que podem observar a la <span class="figref"><a href="#Figura2.1"><span>figura</span></a></span> hi teniu la típica barra de menús de LibreOffice.org i a sota una barra d’eines reduïda. Les funcions s’activaran quan comenceu a introduir informació.
</p>
<div class="iocfigure"><a name="Figura2.1"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Disseny de taula

</figcaption><img src="../media/2.1.png" alt="" /></figure>

</p>
</div>
</div>

<h2><a id="camps_de_la_taula" >Camps de la taula</a></h2>
<div class="level2">

<p>
Com ja sabeu, <strong>l’estructura interna de la taula està formada per camps</strong> com podeu veure a la <span class="figref"><a href="#Figura2.2"><span>figura</span></a></span>. Aquests camps determinen el caràcter de la informació que emmagatzemen i s’identifiquen mitjançant un <em>nom de camp</em>. Per exemple, en una taula en la qual s’emmagatzemin les dades dels proveïdors, un camp imprescindible seria el nom del proveïdor, un altre el tipus d’article que subministra. També podríem incloure la persona encarregada dels contactes, la forma de cobrament, descomptes que realitza… i així fins a completar tota la informació que desitgeu emmagatzemar sobre el proveïdor.
</p>
<div class="iocfigure"><a name="Figura2.2"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Camps

</figcaption><img src="../media/2.2.png" alt="" /></figure>

</p>
</div>
<p>

</p>

<p>
En principi pot ser vàlida qualsevol denominació a l’hora de crear un camp d’una taula. No obstant això, és convenient complir algunes normes:
</p>
<ul>
<li class="level1"><div class="li"> El nom del camp ha de descriure, en la mesura del possible, la informació que emmagatzema: nom, data, grup, etc.</div>
</li>
<li class="level1"><div class="li"> Intenteu que no sigui tan curt que no permeti endevinar el seu contingut, ni tan llarg que resulti incòmode treballar-hi. </div>
</li>
<li class="level1"><div class="li"> És aconsellable no utilitzar símbols o caràcters especials (guions, espais en blanc…) que puguin generar problemes amb certes operacions o en traslladar la base de dades a altres sistemes.</div>
</li>
<li class="level1"><div class="li"> Trieu amb cura el tipus de dades per optimitzar al màxim la base de dades. Cal resumir molt el tipus que indica si emmagatzemarem text al camp, nombres o ambdós. </div>
</li>
<li class="level1"><div class="li"> No dubteu en utilitzar la columna <em>Descripció</em> per indicar el propòsit de cada un dels camps.</div>
</li>
<li class="level1"><div class="li"> El nom dels camps no pot començar per espais ni contenir signes de puntuació ni claudàtors.</div>
</li>
<li class="level1"><div class="li"> No poden existir dos camps amb el mateix nom a la mateixa taula.</div>
</li>
</ul>

</div>

<h2><a id="tipus_de_dades" >Tipus de dades</a></h2>
<div class="level2">

<p>
El tipus de dades determina el caràcter de la informació que conté el camp. No és el mateix emmagatzemar valors numèrics amb els quals posteriorment podreu realitzar operacions matemàtiques, que guardar textos com ara els noms dels articles.
</p>

<p>
Després d’introduir el nom del camp, cal desplegar el quadre de llista associat a la columna <em>Tipus de camp</em>. Apareixerà una llarga llista de possibilitats que es mostren a la <span class="figref"><a href="#Figura2.3"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figura2.3"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Tipus de camp

</figcaption><img src="../media/2.3.png" alt="" /></figure>

</p>
</div>
<p>
El tipus de camp limita el contingut que emmagatzemarà i delimita l’espai de memòria que ocuparà el valor introduït.
</p>

<p>
Quan es planifica el disseny d’una taula s’ha de pensar bé el tipus de camp que es vol definir, tenint present el tipus d’informació que s’hi desarà.
</p>

<p>

</p>

<p>
Aquí teniu una llista de la principal tipologia de camps amb les seves característiques més importants:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Enter [INTEGER]</strong>, nombre enter qualsevol amb capacitat d’emmagatzemar 10 dígits.</div>
</li>
<li class="level1"><div class="li"> <strong>Enter minúscul [TINYINT]</strong>, nombre enter molt petit. Només accepta 3 dígits.</div>
</li>
<li class="level1"><div class="li"> <strong>Enter petit [SMALLINT]</strong>, nombre enter amb valors que no sobrepassin els 5 dígits.</div>
</li>
<li class="level1"><div class="li"> <strong>Número fraccionari o decimal [FLOAT]</strong>, nombre decimal capaç d’emmagatzemar valors que no sobrepassin els 17 dígits entre dígits enters i dígits decimals.</div>
</li>
<li class="level1"><div class="li"> <strong>Número real o decimal [REAL]</strong>, nombre decimal capaç d’emmagatzemar valors que sobrepassin els 17 dígits.</div>
</li>
<li class="level1"><div class="li"> <strong>Text [VARCHAR]</strong>, tipus de camp destinat a cadenes de caràcters la longitud dels quals no és fixa. La propietat <em>Longitud</em> determina la seva longitud màxima. Aquest tipus de camp permet escriure qualsevol caràcter que sigui alfabètic (lletres) o numèric, això sí, no permet fer operacions numèriques ja que tracta els nombres com si fossin lletres.</div>
</li>
<li class="level1"><div class="li"> <strong>Text [VARCHAR_IGNORECASE]</strong>, aquest és un tipus de camp semblant a l’anterior, però es diferencia perquè no s’hi distingeixen majúscules ni minúscules a l’hora de fer una cerca.</div>
</li>
<li class="level1"><div class="li"> <strong>Text (fix) [CHAR]</strong>, tipus de camp destinat a cadenes de caràcter de longitud fixa. Permet que tots els valors d’aquest camp dels diferents registres siguin iguals en grandària. Normalment s’utilitza per a textos de mida fixa o poc variable, com per exemple el codi postal, el telèfon, el tractament personal, textos predefinits…</div>
</li>
<li class="level1"><div class="li"> <strong>Memo [LONGVARCHAR]</strong>, de tipus caràcter destinat a emmagatzemar textos de gran longitud com ara comentaris, etc.</div>
</li>
<li class="level1"><div class="li"> <strong>Data [DATE]</strong>, aquest tipus de dades s’utilitza per emmagatzemar dates. El format de presentació es pot seleccionar a la propietat Format (per exemple dd/mm/aa).</div>
</li>
<li class="level1"><div class="li"> <strong>Hora [TIME]</strong>, aquest tipus de dades s’utilitza per emmagatzemar informació referida a hores. El format de presentació es pot seleccionar a la propietat <em>Format</em> (per exemple hh:mm:ss).</div>
</li>
<li class="level1"><div class="li"> <strong>Data i hora [TIMESTAMP]</strong>, combinació de data i hora.</div>
</li>
<li class="level1"><div class="li"> <strong>Si/No [BOOLEAN]</strong>, aquest tipus de dades, conegut com a booleà, s’utilitza per emmagatzemar només 2 valors: Si/No, 0/1, true/false.</div>
</li>
<li class="level1"><div class="li"> <strong>Imatge [LONGVARBINAR]</strong>, permet emmagatzemar fotos, imatges, gràfics.</div>
</li>
</ul>
<div class="iocnote"><div class="ioccontent">
<p>
La longitud màxima del tipus <em>Text</em> és de 255 caràcters. Si penseu que el camp superarà aquest límit cal utilitzar el tipus <em>Memo [LONGVARCHAR]</em>.
</p>
</div></div>
<p>
Existeixen altres tipus de camps, com per exemple el tipus <strong>[BIGINT]</strong>, per escriure valors enters molt grans o <strong>[BINARY]</strong>, per emmagatzemar dades binàries de mida fixa, però no s’utilitzen tan freqüentment.
</p>

</div>

<h2><a id="propietats_dels_tipus_de_dades" >Propietats dels tipus de dades</a></h2>
<div class="level2">

<p>
Cada vegada que trieu un tipus de dada, la part inferior de la finestra de disseny mostra una tot un seguit d’opcions que permeten ajustar el comportament del camp a les necessitats de cada situació. A la <span class="figref"><a href="#Figura2.4"><span>figura</span></a></span> podeu veure les propietats del tipus <em>Text</em>. En aquest cas, cal destacar la segona de les opcions anomenada <em>Longitud</em>, amb la qual podreu establir la mida màxima de la cadena de caràcters que contindrà el camp.
</p>
<div class="iocfigure"><a name="Figura2.4"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Propietats camp

</figcaption><img src="../media/2.4.png" alt="" /></figure>

</p>
</div>
<p>
Hi ha propietats compartides per més d’un tipus de dada i n’hi ha d’altres d’específiques, només disponibles en alguns tipus de dades. Les més importants són:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Valor automàtic</strong>: en activar aquesta opció serà LibreOffice Base l’encarregat d’afegir nous valors al camp. Els valors són seqüencials i diferents de manera que aquesta propietat és especialment útil per associar-la a camps clau de la base de dades. <strong>Només apareix en els camps de tipus Integer</strong>.</div>
</li>
<li class="level1"><div class="li"> <strong>Expressió increment automàtic</strong>: aquesta propietat apareix automàticament després de definir l’opció anterior com a <em>Sí</em>. La seva funció és la d’establir el valor d’increment del camp, d’un en un, de dos en dos, etc. En general, l’expressió per defecte serà la que utilitzem.</div>
</li>
<li class="level1"><div class="li"> <strong>Longitud</strong>: especifica el nombre de caràcters per als camps de tipus text o la longitud màxima en els tipus numèrics. Les posicions decimals també compten i es restaran de la mida total.</div>
</li>
<li class="level1"><div class="li"> <strong>Xifres decimals</strong>: Determina el nombre de valors decimals que volem emmagatzemar al camp. </div>
</li>
</ul>
<div class="iocnote"><div class="ioccontent">
<p>
<strong>Truc</strong>
En situar el cursor sobre qualsevol propietat, Base en mostrarà al marge dret una descripció detallada.
</p>
</div></div><ul>
<li class="level1"><div class="li"> <strong>Exemple de format</strong>: feu clic al botó petit que apareix a la dreta d’aquest camp per mostrar el quadre de diàleg que podeu veure a la <span class="figref"><a href="#Figura2.6"><span>figura</span></a></span>. Hi podrem definir amb precisió el model de representació per a les dades al camp. Les possibilitats d’aquest quadre de diàleg són realment interessants.</div>
</li>
</ul>
<div class="iocfigure"><a name="Figura2.6"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Opcions format numèric

</figcaption><img src="../media/2.6.png" alt="" /></figure>

</p>
</div><ul>
<li class="level1"><div class="li"> <strong>Valor per defecte</strong>: aquí podeu escriure el valor per defecte que prendrà el camp després d’afegir un nou registre. Si per exemple en una taula de clients preveieu que la majoria de registres són de Barcelona, podeu posar aquesta propietat amb la qual cosa us estalviareu d’introduir aquesta informació de forma repetida.</div>
</li>
<li class="level1"><div class="li"> <strong>Entrada requerida</strong>: si es tria l’opció <em>Sí</em> per a aquesta propietat s’està obligant l’usuari a introduir una dada en aquest camp. Si no ho feu el registre no es podrà guardar a la taula.</div>
</li>
</ul>
<div class="iocimportant"><div class="ioccontent">
<p>
Les propietats dels camps varien en funció de si el tipus de camp és text, numèric, data, etc.
</p>
</div></div>
</div>

<h2><a id="camps_clau" >Camps clau</a></h2>
<div class="level2">

<p>
En qualsevol base de dades, els registres inclosos en les diferents taules han d’estar perfectament identificats i d’això se n’encarreguen les claus. Traslladant aquest concepte a la vida real, cada ciutadà té un nombre de DNI. Pot haver-hi dues persones amb el mateix nom i fins i tot cognoms iguals, però totes dues es diferenciaran pel seu número de DNI, que és únic.
</p>

<p>
Cada taula ha de contenir almenys un camp que permeti identificar unívocament cada registre. 
</p>

<p>
Aquest camp pot ser real, com el mateix DNI d’una persona. O pot ser un valor que ens inventem per aconseguir la mateixa finalitat, com un nombre que s’assigna automàticament a cada registre, assegurant-vos (realment ho farà Base) que no es repeteixi. Una altra opció és utilitzar una combinació de camps per identificar els registres de la taula. Per exemple podríem definir la combinació de nom i cognoms de la nostra taula per aquesta finalitat. No obstant això, existeix la probabilitat que hi hagi clients amb el mateix nom i cognoms, cosa que fa que no sigui una clau del tot vàlida.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
És important que abans de tancar la taula definiu un camp clau ja que en cas contrari no es pot editar el contingut de la taula per afegir registres. 
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
Si necessiteu utilitzar més d’un camp per compondre la clau d’una taula, n’hi haurà prou amb seleccionar en primer lloc els camps que voleu utilitzar per després fer clic amb el botó dret i triar l’ordre <em>Clau primària</em>. La forma de
seleccionar més d’un camp és mantenir premuda la tecla CTRL mentre feu clic a l’espai situat a l’esquerra del camp.
</p>
</div></div>
</div>

<h2><a id="creacio_d_un_index" >Creació d&#039;un índex</a></h2>
<div class="level2">

<p>
Un índex és una taula oculta que genera Base en la qual estableix el valor del camp que està sent indexat i la posició que ocupa a la taula. D’aquesta manera quan ordeneu per un camp indexat, s’executa aquesta operació de forma molt ràpida. A més si establiu que l’índex és únic (sense duplicats) Base evitarà que introduïu valors repetits en aquest camp. Per exemple, en una taula de clients, si afegiu el camp <em>NIF</em> per a aquest camp podreu definir-lo com un índex únic, i d’aquesta manera no podreu duplicar a un client el NIF ja existent a la vostra taula.
</p>

<p>
Per tant, la creació d’índexs en una base de dades com Base és fonamental per agilitar les operacions de recerca i filtrat de dades a la taula i per evitar errors en la introducció de dades, tot evitant els registres duplicats.
</p>

<p>
Per crear un <strong>índex</strong> que impedeixi introduir dos clients amb idèntic NIF, accediu al quadre de disseny d’índexs fent clic al botó <em>Índex</em> o bé, a través del menú <em>Eines/Disseny d’índex</em>. Òbviament, heu d’estar dins del disseny de la taula a la qual vulgueu afegir índexs (<span class="figref"><a href="#Figura2.7"><span>figura</span></a></span>).
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/boto_index.png" class="imgB" title="Botó Índex/-30" alt="Botó Índex/-30" /></li><li><small>Botó Índex</small></li>
</ul></div>

</p>
<div class="iocfigure"><a name="Figura2.7"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Disseny d’índexs

</figcaption><img src="../media/index2.png" alt="" /></figure>

</p>
</div>
<p>
Apareix el quadre de diàleg de <em>Disseny d’índexs</em> (<span class="figref"><a href="#Figura2.8"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figura2.8"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Quadre de diàleg

</figcaption><img src="../media/index3.png" alt="" /></figure>

</p>
</div>
<p>
Al tauler esquerre hi apareixen els índexs creats i en el panell dret hi apareixen els camps que componen cada índex dissenyat i la possibilitat de triar si serà un índex únic (sense possibilitat de dades duplicades) o un índex amb duplicats. Observeu com en haver definit com a clau principal el camp <em>Id_Client</em>, Base genera automàticament un índex únic per a aquest camp. De tal manera, que no pot haver-hi dos clients amb una mateixa dada en el camp <em>Id_Client</em>. 
</p>

<p>
En definir claus principals en una taula, es genera un índex únic (sense permetre duplicats) per al camp clau primària (<span class="figref"><a href="#Figura2.8b"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figura2.8b"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Index clau principal

</figcaption><img src="../media/index4.png" alt="" /></figure>

</p>
</div>
<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/index5.png" class="imgB" title="Botó Quadre de disseny d&#039;índexs" alt="Botó Quadre de disseny d&#039;índexs" /></li><li><small>Botó Quadre de disseny d&#039;índexs</small></li>
</ul></div>

</p>

<p>
Per crear un índex únic que impedeixi introduir dos NIF idèntics per a dos clients, feu clic al botó del quadre de disseny d’índexs.
</p>

</div>

<h2><a id="importacio_de_taules" >Importació de taules</a></h2>
<div class="level2">

<p>
LibreOffice Base ens permet importar dades procedents d’altres aplicacions senzillament copiant i enganxant. 
</p>
<div class="iocfigure"><a name="imp1"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Importació 1

</figcaption><img src="../media/importacio_1.png" alt="" /></figure>

</p>
</div>
<p>
El procediment consisteix a copiar les dades del fitxer d’origen i enganxar-les a la finestra principal d’una base de dades, tal com es detalla a continuació:
</p>
<ul>
<li class="level1"><div class="li"> En primer lloc cal obrir el fitxer d’origen i copiar les dades, tal com mostra la figura <span class="figref"><a href="#imp1"><span>figura</span></a></span>.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> A continuació, cal situar-se a la finestra principal del fitxer de base de dades on volem fer la importació, fer clic amb el botó dret i escollir l’opció <em>Enganxa</em>, tal com mostra la figura <span class="figref"><a href="#imp2"><span>figura</span></a></span>. </div>
</li>
</ul>
<div class="iocfigure"><a name="imp2"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Importació 2

</figcaption><img src="../media/importacio_2.png" alt="" /></figure>

</p>
</div><ul>
<li class="level1"><div class="li"> S’obrirà un assistent per a la importació de les dades, tal com mostra la figura <span class="figref"><a href="#imp3"><span>figura</span></a></span>.</div>
</li>
</ul>
<div class="iocfigure"><a name="imp3"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Importació 3

</figcaption><img src="../media/importacio_3.png" alt="" /></figure>

</p>
</div><ul>
<li class="level1"><div class="li"> La primera pantalla de l’assistent us permetrà escollir si voleu copiar l’estructura de la taula i les dades, només l’estructura, és a dir, els diferents camps però no els registres, o bé només voleu afegir dades. En aquest últim cas, cal que ja tingueu una taula creada amb la mateixa estructura que la que tenen les dades que voleu copiar. </div>
</li>
<li class="level1"><div class="li"> A la mateixa pantalla també podreu escollir si voleu definir una clau primària. La podeu definir ara o més endavant. Podeu veure les opcions disponibles en aquesta primera pantalla a la figura <span class="figref"><a href="#imp3"><span>figura</span></a></span>.</div>
</li>
<li class="level1"><div class="li"> Al pas següent haureu de triar quins són els camps que voleu afegir, poden ser tots o només alguns. Tal com mostra la figura <span class="figref"><a href="#imp4"><span>figura</span></a></span>, els botons del centre us ajudaran.</div>
</li>
</ul>
<div class="iocfigure"><a name="imp4"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Importació 4

</figcaption><img src="../media/importacio_4.png" alt="" /></figure>

</p>
</div><ul>
<li class="level1"><div class="li"> A continuació podreu assignar les propietats a cadascun dels camps, tal com mostra la figura <span class="figref"><a href="#imp5"><span>figura</span></a></span>.</div>
</li>
</ul>
<div class="iocfigure"><a name="imp5"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Importació 5

</figcaption><img src="../media/importacio_5.png" alt="" /></figure>

</p>
</div><ul>
<li class="level1"><div class="li"> Un cop assignades les propietats, premeu el botó <em>Crea</em>. L’assistent us indicarà que cal que assigneu una clau primària, tal com mostra la figura <span class="figref"><a href="#imp6"><span>figura</span></a></span>. Podeu deixar que el mateix programa l’assigni i, si no és la que voleu, més endavant podeu editar la taula i canviar-la.</div>
</li>
</ul>
<div class="iocfigure"><a name="imp6"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Importació 6

</figcaption><img src="../media/importacio_6.png" alt="" /></figure>

</p>
</div><ul>
<li class="level1"><div class="li"> Un cop cliqueu el botó <em>Sí</em>, es genererà la taula i la podreu editar o obrir, tal com mostra la figura <span class="figref"><a href="#imp7"><span>figura</span></a></span>.</div>
</li>
</ul>
<div class="iocfigure"><a name="imp7"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Importació 7

</figcaption><img src="../media/importacio_7.png" alt="" /></figure>

</p>
</div>
</div>

<h2><a id="edicio_de_dades_en_taules" >Edició de dades en taules</a></h2>
<div class="level2">

<p>
Un cop creada la taula, afegits els camps necessaris i assignada la clau primària per reconèixer inequívocament cada registre, el següent pas serà introduir en la taula tota la informació que desitgeu emmagatzemar.
</p>

</div>

<h3><a id="afegir_dades_a_una_taula" >Afegir dades a una taula</a></h3>
<div class="level3">

<p>
Una vegada definida i creada l’estructura de la taula, ho teniu tot disposat per començar a introduir dades. Si bé és cert que els formularis són l’eina específica per afegir informació en una base de dades, podeu prescindir-ne a l’hora de realitzar petites operacions d’edició. En aquests casos podeu treballar directament sobre les taules de la vostra base de dades, afegint nous registres, modificant valors o eliminant qualsevol dada.
</p>

</div>

<h4><a id="barra_edicio_registres" >Barra edició registres</a></h4>
<div class="level4">

<p>
Analitzem els diferens botons de la barra d’edició de dades (<span class="figref"><a href="#FFX1"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="FFX1"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Barra edició registres

</figcaption><img src="../media/barra_edicio_registres.png" alt="" /></figure>

</p>
</div><ol>
<li class="level1"><div class="li"> Permet guardar el registre actual.</div>
</li>
<li class="level1"><div class="li"> Permet editar les dades.</div>
</li>
<li class="level1"><div class="li"> Permet retallar un registre.</div>
</li>
<li class="level1"><div class="li"> Permet copiar un registre.</div>
</li>
<li class="level1"><div class="li"> Permet enganxar un registre.</div>
</li>
<li class="level1"><div class="li"> Permet desfer una entrada de dades.</div>
</li>
<li class="level1"><div class="li"> Permet cercar un registre.</div>
</li>
<li class="level1"><div class="li"> Permet refescar la taula.</div>
</li>
<li class="level1"><div class="li"> Permeten ordenar els registres en ordre ascendent o descendent o amb paràmetres.</div>
</li>
<li class="level1"><div class="li"> Comandaments que permeten filtrar informació.</div>
</li>
</ol>

<p>
Amb aquests passos podeu anar afegint dades a la taula, però no oblideu que en acabar d’introduir tots els camps d’un registre i passar al següent, l’anterior quedarà guardat automàticament a la taula. 
</p>

<p>
El botó <em>Desa</em> també permet fer aquesta mateixa acció de forma manual.
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/boto_guarda.png" class="imgB" title="Botó Desa/-10" alt="Botó Desa/-10" /></li><li><small>Botó Desa</small></li>
</ul></div>

</p>
<div class="iocimportant"><div class="ioccontent">
<p>
És important saber que la comanda <em>Desfer</em> <strong>no</strong> permet anul·lar la inserció d’un registre complet.
</p>
</div></div>
<p>
En introduir les dades heu de tenir la precaució d’omplir els camps d’acord amb la definició que hem fet de la taula. Base no detecta tots els errors i, en aquest cas, és possible que transformi les dades a un valor per defecte equivocat. De la mateixa manera, si intenteu emmagatzemar un registre sense omplir un camp que hem definit com d’<strong>entrada requerida</strong>, Base ens ho impedirà amb la corresponent finestra d’avís i amb un missatge incomprensible, tal com mostra la <span class="figref"><a href="#Figura2.16"><span>figura</span></a></span>. En principi només ens ha de preocupar la primera part del missatge: <strong>Error en inserir un nou registre de dades.</strong>
</p>
<div class="iocfigure"><a name="Figura2.16"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Missatge d’error

</figcaption><img src="../media/2.16.png" alt="" /></figure>

</p>
</div>
</div>

<h3><a id="caracteristiques_interessants_del_mode_edicio" >Característiques interessants del mode Edició</a></h3>
<div class="level3">

<p>
A la finestra d’edició trobeu una sèrie d’eines que us poden ajudar a l’hora de treballar amb la informació de la taula:
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/boto_edicio.png" class="imgB" title="Botó Edició" alt="Botó Edició" /></li><li><small>Botó Edició</small></li>
</ul></div>

</p>
<ul>
<li class="level1"><div class="li"> El botó <em>Edició</em> serveix per alternar entre el mode <em>Edició</em> i <em>Només lectura</em>. En el primer cas podem afegir, modificar i eliminar dades de la taula. Es reconeix perquè l’última fila de la taula apareix amb una icona de flaix a la columna de l’esquerra. En el segon mode només podem llegir la informació de la taula.</div>
</li>
</ul>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/boto_refresca.png" class="imgB" title="Botó Refresca" alt="Botó Refresca" /></li><li><small>Botó Refresca</small></li>
</ul></div>

</p>
<ul>
<li class="level1"><div class="li"> El botó <em>Refresca</em> permet actualitzar les dades de la taula o reconstruir-les si s’haguessin realitzat modificacions en l’estructura.</div>
</li>
</ul>

<p>
Observeu a la <span class="figref"><a href="#Figura2.17"><span>figura</span></a></span> com la part inferior de la finestra mostra uns botons que permeten desplaçar-vos a través dels registres de la taula, en cas que aquesta fos molt extensa i no cabés a la finestra. A l’esquerra apareix el número del registre actiu amb el número de registres a la taula. 
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Recordeu que les combinacions de tecles <em>Control + C</em> (copiar), <em>Control + X</em> (tallar) i <em>Control + V</em> (enganxar) són el mètode més ràpid per utilitzar aquestes comandes. En qualsevol cas, també els podeu trobar a <em>Edita</em>.
</p>
</div></div>
<p>
A la part inferior de la taula, la barra de la <span class="figref"><a href="#Figura2.17x"><span>figura</span></a></span> indica el nombre de registres que conté la taula i el registre on esteu situats.
</p>
<div class="iocfigure"><a name="Figura2.17"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Finestra edició

</figcaption><img src="../media/2.17.png" alt="" /></figure>

</p>
</div><div class="iocfigure"><a name="Figura2.17x"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Barra de registres

</figcaption><img src="../media/barra_registres.png" alt="" /></figure>

</p>
</div>
<p>
LibreOffice Base no permet copiar registres sencers. Però no tindreu cap problema per utilitzar els comandaments <em>Tallar</em>, <em>Enganxar</em> i <em>Copiar</em> amb el contingut de qualsevol camp de la taula.
</p>

</div>

<h3><a id="eliminar_registres" >Eliminar registres</a></h3>
<div class="level3">

<p>
Abans d’aprendre a eliminar un o més registres heu de conèixer la forma de seleccionar-los. Per això, feu clic en l’espai de color situat a
l’esquerra de cada registre i que hem ressaltat en la <span class="figref"><a href="#Figura2.18"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figura2.18"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Selecció de registres

</figcaption><img src="../media/2.18.png" alt="" /></figure>

</p>
</div>
<p>
Hi ha la possibilitat d’eliminar diversos registres a la vegada. Per això feu clic al marge esquerre del primer, mantingueu premuda la tecla <em>Maj</em> i, a continuació, seleccioneu l’últim dels registres que voleu esborrar. Després, tots els registres situats entre els dos marcats quedaran seleccionats. Si utilitzeu la tecla <em>Control</em>, podreu seleccionar registres no consecutius tal com mostra la <span class="figref"><a href="#Figura2.19"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figura2.19"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Selecció de registres no consecutius

</figcaption><img src="../media/2.19.png" alt="" /></figure>

</p>
</div>
<p>

</p>

<p>
Finalment, per eliminar un o diversos registres prèviament seleccionats, fem clic amb el botó dret en l’espai gris situat a la seva esquerra.
Apareixerà un menú emergent en el qual seleccionarem l’opció <em>Elimina files</em> tal com podeu veure a la <span class="figref"><a href="#Figura2.20"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figura2.20"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Eliminar un o diversos registres

</figcaption><img src="../media/2.20b.png" alt="" /></figure>

</p>
</div>
<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/2.20.png" class="imgB" title="Eliminar registres: menú contextual" alt="Eliminar registres: menú contextual" /></li><li><small>Eliminar registres: menú contextual</small></li>
</ul></div>

</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Un cop eliminat el registre no existeix cap ordre que permeti desfer l’operació, de manera que heu d’estar completament segurs abans d’executar-la.
</p>
</div></div>
</div>

<h3><a id="duplicar_registres" >Duplicar registres</a></h3>
<div class="level3">

<p>
LibreOffice Base ofereix un mètode senzill per duplicar un o diversos registres. 
Aquest mètode pot estalviar feina a l’hora d’introduir informació similar a la taula:
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/suma.png" class="imgB" title=" Al costat del cursor apareixerà aquest símbol." alt=" Al costat del cursor apareixerà aquest símbol." /></li><li><small> Al costat del cursor apareixerà aquest símbol.</small></li>
</ul></div>

</p>
<ol>
<li class="level1"><div class="li"> Seleccioneu el registre o els registres que voleu duplicar.</div>
</li>
<li class="level1"><div class="li"> A continuació feu clic, mantingueu premut el botó esquerre del ratolí i arrossegueu, fins que al costat del cursor aparegui un petit símbol <em>més</em>. En aquest moment, podeu deixar anar el botoó del ratolí, i els registres seleccionats apareixeran duplicats al final de la taula.</div>
</li>
</ol>
<div class="iocimportant"><div class="ioccontent">
<p>
Si en duplicar registres el camp clau està configurat com a automàtic no hi haurà cap problema ja que serà el mateix programa el que s’encarregarà d’assignar el valor adequat. Si no és així, Base mostrarà un missatge d’error i situarà el cursor sobre el camp clau perquè introduïu la dada correcta. Després d’això, podreu validar el registre sense cap problema.
</p>
</div></div>
</div>

<h2><a id="cercar_informacio_en_una_taula" >Cercar informació en una taula</a></h2>
<div class="level2">

<p>
Quan treballeu amb bases de dades, la recerca d’informació sol dur-se a terme mitjançant consultes. No obstant això, quan només voleu localitzar un nombre reduït de dades o no aplicareu criteris molt complexos, podeu fer la cerca des de l’eina de recerca en taules. Amb aquesta eina podreu localitzar qualsevol registre a partir del contingut de qualsevol dels seus camps.
</p>

<p>
Feu clic sobre el botó <em>Cercar registres de dades</em> per mostrar el quadre de diàleg que apareix a la <span class="figref"><a href="#Figura2.23"><span>figura</span></a></span>. Aquest quadre de diàleg està dividit en tres seccions, de les quals ens n’interessen dues: 
</p>
<ul>
<li class="level1"><div class="li"> L’opció <em>Text</em> situada a la secció <em>Cerca per</em>, serà on haureu d’introduir la paraula o terme que desitgeu buscar a la taula. Podeu especificar una cadena de caràcters o un nombre, o bé podeu fer que l’eina de recerca localitzi aquells camps amb un camp buit (<em>NULL</em>) o amb un camp no buit.</div>
</li>
<li class="level1"><div class="li"> A la segona secció, <em>Àrea</em>, especificareu si voleu que Base busqui per tots els camps de la taula o bé es limiti a buscar en un camp específic.</div>
</li>
<li class="level1"><div class="li"> A <em>Paràmetres</em>, podeu establir les condicions de la cerca.</div>
</li>
</ul>
<div class="iocimportant"><div class="ioccontent">
<p>
Una opció interessant de la cerca, és la possibilitat d’utilitzar comodins en camps de text.
</p>
</div></div>
<p>
El caràcter comodí <code>?</code> equival a un caràcter i el caràcter comodí <code>*</code> equival a un conjunt de caràcters. Per exemple l’expressió <code>c?la</code> cercaria registres amb els valors <code>cola</code> i <code>cala</code> i l’expressió <code>s*</code> retornaria els registres amb qualsevol valor que comencés per <code>s</code>.
</p>
<div class="iocfigure"><a name="Figura2.23"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Cercar registres

</figcaption><img src="../media/2.23.png" alt="" /></figure>

</p>
</div>
</div>

<h2><a id="ordenacio_basica_de_dades" >Ordenació bàsica de dades</a></h2>
<div class="level2">

<p>
Per defecte, cada vegada que obriu una taula es mostraran els registres en l’ordre en què s’han introduït. No obstant això, podeu fer que els registres s’ordenin de forma ascendent o descendent en funció de qualsevol dels camps que conformen la taula.
</p>
<ul>
<li class="level1"><div class="li"> Feu clic sobre el nom del camp pel qual voleu que s’ordenin els registres. Després de marcar, apareixerà seleccionada la columna corresponent tal com es mostra a la <span class="figref"><a href="#Figura2.24"><span>figura</span></a></span>.</div>
</li>
</ul>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ordenar_registres_2.png" class="imgB" title="Ordre ascendent" alt="Ordre ascendent" /></li><li><small>Ordre ascendent</small></li>
</ul></div>

</p>
<ul>
<li class="level1"><div class="li"> A continuació feu clic sobre el botó d’ordenació automàtica en ordre ascendent o al botó d’ordenació automàtica en ordre descendent segons sigui necessari.</div>
</li>
</ul>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ordenar_registres.png" class="imgB" title="Ordre descendent" alt="Ordre descendent" /></li><li><small>Ordre descendent</small></li>
</ul></div>

</p>
<ul>
<li class="level1"><div class="li"> Automàticament apareixerà la taula amb els registres ordenats.</div>
</li>
</ul>
<div class="iocfigure"><a name="Figura2.24"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Ordenar registres

</figcaption><img src="../media/2.24.png" alt="" /></figure>

</p>
</div>
<p>
Podeu establir fins a tres condicions per ordenar els registres d’una taula com podeu veure a la <span class="figref"><a href="#Figura2.24b"><span>figura</span></a></span>
</p>
<div class="iocfigure"><a name="Figura2.24b"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

 Condicions d’ordenació

</figcaption><img src="../media/figura2.24b.png" alt="" /></figure>

</p>
</div>
</div>

<h2><a id="autofiltre" >Autofiltre</a></h2>
<div class="level2">

<p>
En determinades ocasions pot interessar-vos mostrar només certs registres de la taula però sense utilitzar una consulta gaire complicada.
</p>

<p>
La forma més senzilla de fer-ho és utilitzar l’eina <em>Autofiltre</em>  que permet mostrar a la finestra de dades només aquells registres en els quals el valor del camp coincideix amb el valor seleccionat.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Per tal de filtrar per dues condicions, heu de fer el primer filtratge i un cop obtingueu el resultat tornar a aplicar el segon filtratge sobre el resultat mostrat.
</p>
</div></div>
<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/elimina_filtre.png" class="imgB" title="Per tal de recuperar l&#039;aspecte original de la taula i mostrar-ne de nou tots els registres, feu clic a la icona Elimina filtre./-20" alt="Per tal de recuperar l&#039;aspecte original de la taula i mostrar-ne de nou tots els registres, feu clic a la icona Elimina filtre./-20" /></li><li><small>Per tal de recuperar l&#039;aspecte original de la taula i mostrar-ne de nou tots els registres, feu clic a la icona Elimina filtre.</small></li>
</ul></div>

</p>

</div>

<h2><a id="modificar_l_aparenca_d_una_taula" >Modificar l&#039;aparença d&#039;una taula</a></h2>
<div class="level2">

<p>
LibreOffice Base permet tot de petites modificacions sobre l’aspecte de les taules. Per exemple:
</p>
<ul>
<li class="level1"><div class="li"> Per modificar l’amplada d’una columna feu clic amb el botó dret sobre la seva capçalera i seleccioneu l’opció <em>Ample de columna</em>. Si trieu <em>Automàtic</em> serà Base qui li assigni l’amplada de manera que es puguin llegir totes les dades d’aquesta.</div>
</li>
<li class="level1"><div class="li"> Una altra manera de modificar l’amplada d’una columna és utilitzar el ratolí. Situeu-vos amb el punter del ratolí en un dels límits laterals de la primera cel·la de la columna que vulgueu modificar. El punter es transforma en una doble fletxa. En aquest moment feu clic amb el ratolí i arrossegueu cap a l’esquerra o la dreta el límit de la columna.</div>
</li>
<li class="level1"><div class="li"> Per modificar l’alçada de les files, els mètodes disponibles són els mateixos que hem descrit per les columnes llevat que, en aquest cas, <strong>les modificacions afecten a totes les files de la mateixa manera</strong>.</div>
</li>
<li class="level1"><div class="li"> Si voleu canviar la font de text utilitzada per mostrar les dades de la taula, feu clic amb el botó dret sobre l’espai situat a l’esquerra de cada fila i a continuació seleccioneu la comanda <em>Formatat de taules</em>. LibreOffice Base mostrarà el quadre de diàleg que podeu veure a la <span class="figref"><a href="#Figura2.27b"><span>figura</span></a></span>, en el qual podreu triar la font de text, la seva grandària, l’estil, així com altres efectes de font.</div>
</li>
<li class="level1"><div class="li"> Feu clic amb el botó dret sobre la capçalera de qualsevol columna i seleccioneu la comanda <em>Formatat de columnes</em>. Entre les possibilitats que ofereix el quadre de diàleg podreu modificar l’alineació de les dades i aplicar-hi diferents formats.</div>
</li>
<li class="level1"><div class="li"> Per acabar, cal tenir en compte LibreOffice Base permet ocultar una o més columnes de la taula temporalment. Per fer-ho seleccioneu la columna que voleu amagar i feu-hi clic amb el botó dret per seleccionar l’opció <em>Amaga columna</em>. Per tornar a fer-la visible haureu de fer clic amb el botó dret sobre qualsevol cel·la de la primera fila, seleccionar l’opció <em>Mostra columnes</em> i finalment fer clic sobre la columna que vulgueu que torni a ser visible o bé sobre l’opció <em>Totes</em>. Observeu la <span class="figref"><a href="#Figura2.28"><span>figura</span></a></span>.</div>
</li>
</ul>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/boto_ample_columna.png" class="imgB" title="Punter en forma de doble fletxa./-160" alt="Punter en forma de doble fletxa./-160" /></li><li><small>Punter en forma de doble fletxa.</small></li>
</ul></div>

</p>
<div class="iocnote"><div class="ioccontent">
<p>
Totes aquestes modificacions es perdran si no es guarden els canvis en sortir de LibreOffice Base, no de la vista full de dades de la taula.
</p>
</div></div><div class="iocfigure"><a name="Figura2.27b"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Formatar taula

</figcaption><img src="../media/2.27b.png" alt="" /></figure>

</p>
</div><div class="iocfigure"><a name="Figura2.28"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Mostra columnes

</figcaption><img src="../media/2.28.png" alt="" /></figure>

</p>
</div>
</div>

<h2><a id="l_assistent_per_a_taules" >L&#039;assistent per a taules</a></h2>
<div class="level2">

<p>
L’assistent per a taules de Base inclou un gran nombre de taules predissenyades que podeu configurar i utilitzar en tan sols uns minuts. La utilització d’aquesta possibilitat que ofereix Base té algunes limitacions.
</p>

<p>
Utilitzeu aquesta opció de Base per comprovar tot el seu potencial.
</p>

</div>

<h2><a id="relacions_entre_taules" >Relacions entre taules</a></h2>
<div class="level2">

<p>
LibreOffice Base és un gestor de base de dades relacional perquè, entre altres coses, permet establir vincles o relacions entre les taules que el componen.
</p>

<p>
L’objectiu d’aquestes relacions és principalment evitar la duplicitat d’informació i, en conseqüència, optimitzar el rendiment de la base de dades.
</p>

</div>

<h3><a id="concepte_de_relacio" >Concepte de relació</a></h3>
<div class="level3">

<p>
Vegem un senzill exemple de relació entre les taules <em>Clients</em>i <em>Detall Comandes</em>.
</p>

<p>
L’estructura d’aquestes taules provoca una important redundància de dades que repercuteix directament sobre l’eficàcia del sistema.
</p>

<p>
La forma de solucionar aquest problema és senzilla: relacionar les taules
i substituir tota la informació de clients de la taula <em>Comandes</em> per la clau del client. D’aquesta manera, quan sigui necessari utilitzareu el camp clau del client per accedir a la taula <em>Clients</em> i obtenir-ne les dades necessàries.
</p>

<p>
En tota relació hi intervenen dues taules. La primera és la que conté la informació completa i la denominarem <em>taula principal</em>, la segona la denominarem <em>taula secundària</em> i és la que enllaça des dades de la taula principal amb la taula secundària.
</p>

</div>

<h3><a id="tipus_de_relacions" >Tipus de relacions</a></h3>
<div class="level3">

<p>
La redundància d’informació no és gens recomanable quan es treballa amb bases de dades que contenen una gran quantitat d’informació.
</p>

<p>
La solució passa per <strong>relacionar</strong> les taules amb informació coincident de manera que no hi hagi duplicitat d’informació. Tot això, dit d’una altra manera, seria: per què escriure dues vegades el mateix si puc fer-ho una sola vegada i treballar de la mateixa manera?.
</p>

<p>
Tornant al nostre exemple, si relacionem les taules <em>Clients</em> i <em>Productes</em> mitjançant el <em>Codi</em> del client n’hi hauria prou amb indicar a la taula <em>Clients</em> aquest valor per tal d’obtenir el nombre de productes que ha comprat un determinat client.
</p>

<p>
No sempre les condicions per establir vincles entre dues taules són iguals. La manera com es relacionen les taules entre si dóna lloc a comportaments diferents. En l’estructutura de qualsevol base de dades trobem principalment tres tipus de relacions que es descriuen de la següent manera:
</p>
<ul>
<li class="level1"><div class="li"> Un a molts</div>
</li>
<li class="level1"><div class="li"> Molts a molts</div>
</li>
<li class="level1"><div class="li"> Un a un</div>
</li>
</ul>

<p>
Dels tres tipus, el més utilitzat i recomanable en la majoria dels casos serà el model <em>Un a molts</em>.
</p>

</div>

<h4><a id="un_a_molts" >Un a molts</a></h4>
<div class="level4">

<p>
Vegem el primer model de relació prenent com a referència les taules <em>Categories</em> i <em>Productes</em>. Qualsevol article (<em>molts</em>) pertany només a un grup (<em>un</em>). Un article no pot ser en més d’una categoria. Doncs bé, ni més ni menys que aquest seria l’argument d’una relació <em>un a molts</em>.
</p>

<p>
Un altre exemple. Sabem que cada client pot fer diverses comandes, però que cada comanda l’ha feta un client. D’aquí podem extreure’n una relació <em>un a molts</em> entre les taules <em>Clients</em> i <em>Comandes</em>.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
En les relacions d’<em>un a molts</em> cada registre d’una taula A, a la qual anomenarem <em>taula primària</em>, pot estar enllaçat amb més d’un registre d’una altra taula B, a la qual anomenarem <em>taula secundària</em>. En canvi, cada registre de la taula B només pot estar enllaçat a un registre de la taula A.
</p>

<p>
<em>Un a molts</em> o <em>molts a un</em> únicament es diferencia en el sentit de la relació, és a dir, si la taula primària es troba a l’esquerra o dreta de la relació. En realitat es tracta del mateix tipus de relació i és la més convenient d’utilitzar.
</p>
</div></div>
</div>

<h4><a id="un_a_un" >Un a un</a></h4>
<div class="level4">

<p>
Les relacions <em>un a un</em> no són massa freqüents però n’hi ha, així que les heu de conèixer. Buscant alguna coincidència en el nostre entorn que ens pugui servir com a exemple trobem el vincle entre una comanda i la seva factura. Tal com sabeu, cada comanda genera una factura (<em>un</em>) i de la mateixa manera, cada factura o tiquet de venda només pot tenir una comanda. Aquesta seria una relació <em>un a un</em>.
</p>

</div>

<h4><a id="molts_a_molts" >Molts a molts</a></h4>
<div class="level4">

<p>
Si voleu conèixer els articles que han comprat els clients o els clients que han comprat determinats articles, en principi necessiteu dues taules: <em>Clients</em> i <em>Productes</em>. I quina seria la relació entre aquestes dues taules? Doncs bé, per establir-la podríeu llegir que un client compra diversos articles, i un article pot ser comprat per diversos clients. Per tant, us trobareu entre una relació <em>molts a molts</em>.
</p>

<p>
Des d’un punt de vista teòric diríem que en les relacions <em>molts a molts</em> a cada registre de la taula A se li poden associar diversos registres de la taula B i cada registre de la taula B pot estar relacionat amb més d’un registre de la taula A.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Per establir una relació <em>molts a molts</em> entre dues taules s’utilitza una taula intermèdia que es relaciona d’un a molts amb cadascuna de les dues taules que es volen relacionar.
</p>
</div></div>
</div>

<h3><a id="establir_relacions_entre_taules" >Establir relacions entre taules</a></h3>
<div class="level3">

<p>
Un requisit indispensable per establir una relació entre dues taules és que ambdues taules tinguin un camp en comú. Observeu la <span class="figref"><a href="#Figura2.35"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figura2.35"></a>
<p>
 <figure>
<figcaption><span class="figuretitle">Figura</span>

Relacions entre taules

</figcaption><img src="../media/2.35.png" alt="" /></figure>

</p>
</div><div class="iocimportant"><div class="ioccontent">
<p>
Els camps que s’utilitzen per establir la relació entre dues taules han de ser del mateix tipus <em>integer, text, small integer</em>, etc. 
</p>

<p>
Habitualment, per a aquest propòsit, se solen utilitzar tipus enters (<em>Integer</em>) però se’n podrien utilitzar de qualsevol altre tipus, sempre que fos el mateix en les dues taules.
</p>
</div></div>
<p>
A més, heu de tenir en compte el següent:
</p>
<ul>
<li class="level1"><div class="li"> La propietat <em>Mida</em> del camp ha de ser igual en ambdues taules.</div>
</li>
<li class="level1"><div class="li"> Si el camp a la taula primària està definit com de <em>Valor automàtic</em>, a la taula secundària ha d’estar definit com <em>Integer</em>.</div>
</li>
<li class="level1"><div class="li"> El camp comú ha de ser la clau principal a la taula primària.</div>
</li>
</ul>

</div>

<h3><a id="configurar_relacions" >Configurar relacions</a></h3>
<div class="level3">

<p>
Un cop establerta la relació podeu modificar les seves característiques. 
Cal fer doble clic sobre la línia que representa la relació o bé fer-hi clic amb el botó dret i triar <em>Edita</em>. En ambdós casos, Base mostra el quadre de diàleg que apareix a la <span class="figref"><a href="#Figura2.37"><span>figura</span></a></span> amb la configuració per defecte de la relació.
</p>
<div class="iocfigure"><a name="Figura2.37"></a>
<p>
<figure>
<figcaption><span class="figuretitle">Figura</span>

Configurar relacions

</figcaption><img src="../media/2.37.png" alt="" /></figure>

</p>
</div>
<p>
La relació establerta entre les dues taules implica que qualsevol modificació realitzada sobre la informació que conté la taula primària afectarà les dades de la taula secundària. 
</p>

<p>
Si, per exemple, elimineu la categoria 1 de la taula <em>Categories</em> això afectarà tots els registres de la taula <em>Productes</em> pertanyents a aquest grup. Determinar com reaccionarà la base de dades davant d’aquestes modificacions i d’altres similars és el que permet configurar el quadre de diàleg <em>Relacions</em>.
</p>

<p>
La part inferior del quadre de diàleg <em>Relacions</em> està dividit en dues parts corresponents a l’acció que durà a terme la base de dades quan actualitzeu i quan elimineu un registre de la taula primària respectivament, com podeu veure a la :<span class="figref"><a href="#Figura 2.37"><span>figura</span></a></span>.
</p>
<ul>
<li class="level1"><div class="li"> L’opció <em>Cap acció</em> implica que els canvis a la taula primària no afectaran la taula secundària. Aquesta decisió no és la més adequada, ja que és molt probable que us condueixi a inconsistències a la base de dades.</div>
</li>
<li class="level1"><div class="li"> L’opció <em>Actualitzar</em> i <em>Eliminar cascada</em> implica que a la taula secundària s’eliminaran o actualitzaran els registres en funció de l’acció que es dugui a terme a la taula primària. Segurament aquesta sigui l’elecció més segura i conservadora de les possibles i és la que haureu d’utilitzar en la majoria dels casos.</div>
</li>
<li class="level1"><div class="li"> L’opció <em>Posar null</em> provocarà que, automàticament, el camp relacionat a la taula secundària passi a <em>null</em> (buit) quan es modifiqui la taula primària.</div>
</li>
<li class="level1"><div class="li"> L’opció <em>Per defecte</em> fa que el camp relacionat de la taula secundària sigui substituït pel valor predeterminat definit en la creació de la taula.</div>
</li>
</ul>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u5/a1/exercicis.html">Exercicis d'autoavaluació</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u5/a2/activitats.html">Activitats</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
